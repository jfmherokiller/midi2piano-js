!function e(t,n,r){function a(s,u){if(!n[s]){if(!t[s]){var i="function"==typeof require&&require;if(!u&&i)return i(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n?n:e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(e,t,n){!function(e,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?t.exports=r():e.download=r()}(this,function(){return function e(t,n,r){function a(e){var t=e.split(/[:;,]/),n=t[1],r="base64"==t[2]?atob:decodeURIComponent,a=r(t.pop()),o=a.length,s=0,u=new Uint8Array(o);for(s;s<o;++s)u[s]=a.charCodeAt(s);return new m([u],{type:n})}function o(e,t){if("download"in f)return f.href=e,f.setAttribute("download",v),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),t===!0&&setTimeout(function(){i.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,c)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,c)),n.src=e,setTimeout(function(){document.body.removeChild(n)},333)}var s,u,i=window,c="application/octet-stream",d=r||c,p=t,h=!n&&!r&&p,f=document.createElement("a"),l=function(e){return String(e)},m=i.Blob||i.MozBlob||i.WebKitBlob||l,v=n||"download";if(m=m.call?m.bind(i):Blob,"true"===String(this)&&(p=[p,d],d=p[0],p=p[1]),h&&h.length<2048&&(v=h.split("/").pop().split("?")[0],f.href=h,f.href.indexOf(h)!==-1)){var g=new XMLHttpRequest;return g.open("GET",h,!0),g.responseType="blob",g.onload=function(t){e(t.target.response,v,c)},setTimeout(function(){g.send()},0),g}if(/^data\:[\w+\-]+\/[\w+\-\.]+[,;]/.test(p)){if(!(p.length>2096103.424&&m!==l))return navigator.msSaveBlob?navigator.msSaveBlob(a(p),v):o(p);p=a(p),d=p.type||c}else if(/([\x80-\xff])/.test(p)){var y=0,b=new Uint8Array(p.length),w=b.length;for(y;y<w;++y)b[y]=p.charCodeAt(y);p=new m([b],{type:d})}if(s=p instanceof m?p:new m([p],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(s,v);if(i.URL)o(i.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===l)try{return o("data:"+d+";base64,"+i.btoa(s))}catch(e){return o("data:"+d+","+encodeURIComponent(s))}u=new FileReader,u.onload=function(e){o(this.result)},u.readAsDataURL(s)}return!0}})},{}],2:[function(e,t,n){function r(e){function t(e){var t=e.read(4),n=e.readInt32();return{id:t,length:n,data:e.read(n)}}function n(e){var t={};t.deltaTime=e.readVarInt();var n=e.readInt8();if(240==(240&n)){if(255==n){t.type="meta";var a=e.readInt8(),o=e.readVarInt();switch(a){case 0:if(t.subtype="sequenceNumber",2!=o)throw"Expected length for sequenceNumber event is 2, got "+o;return t.number=e.readInt16(),t;case 1:return t.subtype="text",t.text=e.read(o),t;case 2:return t.subtype="copyrightNotice",t.text=e.read(o),t;case 3:return t.subtype="trackName",t.text=e.read(o),t;case 4:return t.subtype="instrumentName",t.text=e.read(o),t;case 5:return t.subtype="lyrics",t.text=e.read(o),t;case 6:return t.subtype="marker",t.text=e.read(o),t;case 7:return t.subtype="cuePoint",t.text=e.read(o),t;case 32:if(t.subtype="midiChannelPrefix",1!=o)throw"Expected length for midiChannelPrefix event is 1, got "+o;return t.channel=e.readInt8(),t;case 47:if(t.subtype="endOfTrack",0!=o)throw"Expected length for endOfTrack event is 0, got "+o;return t;case 81:if(t.subtype="setTempo",3!=o)throw"Expected length for setTempo event is 3, got "+o;return t.microsecondsPerBeat=(e.readInt8()<<16)+(e.readInt8()<<8)+e.readInt8(),t;case 84:if(t.subtype="smpteOffset",5!=o)throw"Expected length for smpteOffset event is 5, got "+o;var s=e.readInt8();return t.frameRate={0:24,32:25,64:29,96:30}[96&s],t.hour=31&s,t.min=e.readInt8(),t.sec=e.readInt8(),t.frame=e.readInt8(),t.subframe=e.readInt8(),t;case 88:if(t.subtype="timeSignature",4!=o)throw"Expected length for timeSignature event is 4, got "+o;return t.numerator=e.readInt8(),t.denominator=Math.pow(2,e.readInt8()),t.metronome=e.readInt8(),t.thirtyseconds=e.readInt8(),t;case 89:if(t.subtype="keySignature",2!=o)throw"Expected length for keySignature event is 2, got "+o;return t.key=e.readInt8(!0),t.scale=e.readInt8(),t;case 127:return t.subtype="sequencerSpecific",t.data=e.read(o),t;default:return t.subtype="unknown",t.data=e.read(o),t}return t.data=e.read(o),t}if(240==n){t.type="sysEx";var o=e.readVarInt();return t.data=e.read(o),t}if(247==n){t.type="dividedSysEx";var o=e.readVarInt();return t.data=e.read(o),t}throw"Unrecognised MIDI event type byte: "+n}var u;0==(128&n)?(u=n,n=r):(u=e.readInt8(),r=n);var i=n>>4;switch(t.channel=15&n,t.type="channel",i){case 8:return t.subtype="noteOff",t.noteNumber=u,t.velocity=e.readInt8(),t;case 9:return t.noteNumber=u,t.velocity=e.readInt8(),0==t.velocity?t.subtype="noteOff":t.subtype="noteOn",t;case 10:return t.subtype="noteAftertouch",t.noteNumber=u,t.amount=e.readInt8(),t;case 11:return t.subtype="controller",t.controllerType=u,t.value=e.readInt8(),t;case 12:return t.subtype="programChange",t.programNumber=u,t;case 13:return t.subtype="channelAftertouch",t.amount=u,t;case 14:return t.subtype="pitchBend",t.value=u+(e.readInt8()<<7),t;default:throw"Unrecognised MIDI event type: "+i}}var r;stream=a(e);var o=t(stream);if("MThd"!=o.id||6!=o.length)throw"Bad .mid file - header not found";var s=a(o.data),u=s.readInt16(),i=s.readInt16(),c=s.readInt16();if(32768&c)throw"Expressing time division in SMTPE frames is not supported yet";ticksPerBeat=c;for(var d={formatType:u,trackCount:i,ticksPerBeat:ticksPerBeat},p=[],h=0;h<d.trackCount;h++){p[h]=[];var f=t(stream);if("MTrk"!=f.id)throw"Unexpected chunk - expected MTrk, got "+f.id;for(var l=a(f.data);!l.eof();){var m=n(l);p[h].push(m)}}return{header:d,tracks:p}}function a(e){function t(t){var n=e.substr(u,t);return u+=t,n}function n(){var t=(e.charCodeAt(u)<<24)+(e.charCodeAt(u+1)<<16)+(e.charCodeAt(u+2)<<8)+e.charCodeAt(u+3);return u+=4,t}function r(){var t=(e.charCodeAt(u)<<8)+e.charCodeAt(u+1);return u+=2,t}function a(t){var n=e.charCodeAt(u);return t&&n>127&&(n-=256),u+=1,n}function o(){return u>=e.length}function s(){for(var e=0;;){var t=a();if(!(128&t))return e+t;e+=127&t,e<<=7}}var u=0;return{eof:o,read:t,readInt32:n,readInt16:r,readInt8:a,readVarInt:s}}t.exports=function(e){return r(e)}},{}],3:[function(e,t,n){"use strict";var r=e("./processing");window.onload=function(){function e(e){var t=e.target.files,n=t[0],a=new FileReader;new FileReader;a.addEventListener("load",function(){r.parsethefile(a.result)}),a.readAsBinaryString(n)}document.getElementById("file").addEventListener("change",e,!1)}},{"./processing":4}],4:[function(e,t,n){"use strict";function r(t){var n=a(t),r=o.GetTempo(n),s=o.CreateDBLines(o.getnotes(n)),u=o.CreateFileString(s,r),i=e("downloadjs");i(u.join(""),"songtest.txt","text/plain"),console.log("AAAAAAA")}var a=e("midi-file-parser"),o=e("./utilityfunctions");n.parsethefile=r},{"./utilityfunctions":5,downloadjs:1,"midi-file-parser":2}],5:[function(e,t,n){"use strict";function r(e){var t=e.tracks[0].filter(function(e){return null!=e.microsecondsPerBeat})[0].microsecondsPerBeat;return t=6e7/t,t=Math.round(t),10*t}function a(e){for(var t=[],n=0;n<e.tracks.length;n++){t[n]=[];for(var r=0,a=e.tracks[n];r<a.length;r++){var o=a[r];10!==o.channel&&("noteOn"===o.subtype&&t[n].push(o.noteNumber),"noteOff"===o.subtype&&t[n].push(-1))}}for(var s=0;s<t.length;s++)0===t[s].length&&t.splice(s,1);return t}function o(e){var t=[];if(t.push("// Set track wave to channel 0 and start\n"),t.push("wset 0,trackwave;\n"),t.push("chwave 0,0;\n"),t.push("chvolume 0,2.5;\n"),t.push("chstart 0;\n"),t.push("\n"),e>1)for(var n=1;n<e;n++)t.push("// Set track wave to channel "+n+"and start\n"),t.push("wset "+n+",trackwave;\n"),t.push("chwave "+n+","+n+";\n"),t.push("chvolume "+n+",2.5;\n"),t.push("chstart "+n+";\n"),t.push("\n");return t}function s(e){for(var t=[],n=0;n<e.length;n++){for(t[n]=[],t[n].push("track"+n+":\n");e[n].length;)t[n].push("db ".concat(e[n].splice(0,32).join(", ")).concat(";\n"));t[n].push("db 0; // End string\n")}return t}function u(e){var t=[];if(t.push("    // Track 0\n"),t.push("note = 2;\n"),t.push("fpwr note,(track0[i]/12);\n"),t.push("note /= 100;\n"),t.push("chpitch 0,note;\n"),t.push("\n"),e>1)for(var n=1;n<e;n++)t.push("    // Track "+n+"\n"),t.push("note = 2;\n"),t.push("fpwr note,(track"+n+"[i]/12);\n"),t.push("note /= 100;\n"),t.push("chpitch "+n+",note;\n"),t.push("\n");return t}function i(e,t,n){var r=[];return r.push("// Get track length\n"),r.push("tracklen = strlen(track"+t+");\n"),r.push("\n"),r.push("void main()\n"),r.push("{\n"),r.push("    tempo("+n+")\n"),r.push("\n"),r=r.concat(u(e)),r.push("    // Index\n"),r.push("i++; mod i,tracklen;\n"),r.push("\n"),r.push("    // Repeat\n"),r.push("jmp main;\n"),r.push("}\n"),r.push("\n"),r.push("// Accurate tempo function for beats-per-minute\n"),r.push("void tempo( float bpm )\n"),r.push("{\n"),r.push("    timer timestamp;\n"),r.push("    while ((time - timestamp) < (60 / bpm)) { timer time; }\n"),r.push("}\n"),r.push("\n"),r.push("// Returns the length of a string\n"),r.push("float strlen(char* str)\n"),r.push("{\n"),r.push("    char* strptr = str;\n"),r.push("   while (*strptr++);\n"),r.push("  return (strptr - str);\n"),r.push("}\n"),r.push("\n"),r.push("float note, i;\n"),r.push("float tracklen;\n"),r.push("float time, timestamp;\n"),r.push("\n"),r.push('string trackwave,"synth/sine_880.wav";\n'),r.push("\n"),r}function c(e,t){var n=e.map(function(e){return e.length}).indexOf(Math.max.apply(Math,e.map(function(e){return e.length}))),r=o(e.length);r=r.concat(i(e.length,n,t));for(var a=0,s=e;a<s.length;a++){var u=s[a];r=r.concat(u),r.push("\n")}return r}n.GetTempo=r,n.getnotes=a,n.CreateDBLines=s,n.CreateFileString=c},{}]},{},[3]);
//# sourceMappingURL=data.js.map
