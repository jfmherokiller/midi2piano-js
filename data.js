!function t(e,n,r){function a(i,s){if(!n[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(t){var n=e[i][1][t];return a(n?n:t)},p,p.exports,t,e,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){!function(t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?e.exports=r():t.download=r()}(this,function(){return function t(e,n,r){function a(t){var e=t.split(/[:;,]/),n=e[1],r="base64"==e[2]?atob:decodeURIComponent,a=r(e.pop()),o=a.length,i=0,s=new Uint8Array(o);for(i;i<o;++i)s[i]=a.charCodeAt(i);return new m([s],{type:n})}function o(t,e){if("download"in f)return f.href=t,f.setAttribute("download",v),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),e===!0&&setTimeout(function(){u.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,c)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,c)),n.src=t,setTimeout(function(){document.body.removeChild(n)},333)}var i,s,u=window,c="application/octet-stream",p=r||c,h=e,d=!n&&!r&&h,f=document.createElement("a"),l=function(t){return String(t)},m=u.Blob||u.MozBlob||u.WebKitBlob||l,v=n||"download";if(m=m.call?m.bind(u):Blob,"true"===String(this)&&(h=[h,p],p=h[0],h=h[1]),d&&d.length<2048&&(v=d.split("/").pop().split("?")[0],f.href=d,f.href.indexOf(d)!==-1)){var y=new XMLHttpRequest;return y.open("GET",d,!0),y.responseType="blob",y.onload=function(e){t(e.target.response,v,c)},setTimeout(function(){y.send()},0),y}if(/^data\:[\w+\-]+\/[\w+\-\.]+[,;]/.test(h)){if(!(h.length>2096103.424&&m!==l))return navigator.msSaveBlob?navigator.msSaveBlob(a(h),v):o(h);h=a(h),p=h.type||c}else if(/([\x80-\xff])/.test(h)){var g=0,w=new Uint8Array(h.length),b=w.length;for(g;g<b;++g)w[g]=h.charCodeAt(g);h=new m([w],{type:p})}if(i=h instanceof m?h:new m([h],{type:p}),navigator.msSaveBlob)return navigator.msSaveBlob(i,v);if(u.URL)o(u.URL.createObjectURL(i),!0);else{if("string"==typeof i||i.constructor===l)try{return o("data:"+p+";base64,"+u.btoa(i))}catch(t){return o("data:"+p+","+encodeURIComponent(i))}s=new FileReader,s.onload=function(t){o(this.result)},s.readAsDataURL(i)}return!0}})},{}],2:[function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(){function t(t,e,n){this.formatType=t,this.trackCount=e,this.ticksPerBeat=n}return t}(),o=function(){function t(t,e,n){this.id=t,this.length=e,this.data=n}return t}(),i=function(){function t(){}return t}(),s=(function(t){function e(){t.apply(this,arguments)}return r(e,t),e}(i),function(t){function e(){t.apply(this,arguments)}return r(e,t),e}(i),function(){function t(t){this.tracks=new Array;var e;this.stream=new u(t);var n=this.readChunk(this.stream);if("MThd"!==n.id||6!==n.length)throw"Bad .mid file - header not found";var r=new u(n.data),o=r.readInt16(),i=r.readInt16(),s=r.readInt16();if(32768&s)throw"Expressing time division in SMTPE frames is not supported yet";e=s,this.header=new a(o,i,e);for(var c=0;c<this.header.trackCount;c++){this.tracks[c]=new Array;var p=this.readChunk(this.stream);if("MTrk"!==p.id)throw"Unexpected chunk - expected MTrk, got "+p.id;for(var h=new u(p.data);!h.eof();){var d=this.readEvent(h);this.tracks[c].push(d)}}}return t.prototype.readChunk=function(t){var e=t.read(4),n=t.readInt32();return new o(e,n,t.read(n))},t.prototype.readEvent=function(t){var e={};e.deltaTime=t.readVarInt();var n=t.readInt8();if(240===(240&n)){var r;if(255!==n){if(240===n)return e.type="sysEx",r=t.readVarInt(),e.data=t.read(r),e;if(247===n)return e.type="dividedSysEx",r=t.readVarInt(),e.data=t.read(r),e;throw"Unrecognised MIDI event type byte: "+n}e.type="meta";var a=t.readInt8();switch(r=t.readVarInt(),a){case 0:if(e.subtype="sequenceNumber",2!==r)throw"Expected length for sequenceNumber event is 2, got "+r;return e.number=t.readInt16(),e;case 1:return e.subtype="text",e.text=t.read(r),e;case 2:return e.subtype="copyrightNotice",e.text=t.read(r),e;case 3:return e.subtype="trackName",e.text=t.read(r),e;case 4:return e.subtype="instrumentName",e.text=t.read(r),e;case 5:return e.subtype="lyrics",e.text=t.read(r),e;case 6:return e.subtype="marker",e.text=t.read(r),e;case 7:return e.subtype="cuePoint",e.text=t.read(r),e;case 32:if(e.subtype="midiChannelPrefix",1!==r)throw"Expected length for midiChannelPrefix event is 1, got "+r;return e.channel=t.readInt8(),e;case 47:if(e.subtype="endOfTrack",0!==r)throw"Expected length for endOfTrack event is 0, got "+r;return e;case 81:if(e.subtype="setTempo",3!==r)throw"Expected length for setTempo event is 3, got "+r;return e.microsecondsPerBeat=(t.readInt8()<<16)+(t.readInt8()<<8)+t.readInt8(),e;case 84:if(e.subtype="smpteOffset",5!==r)throw"Expected length for smpteOffset event is 5, got "+r;var o=t.readInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=t.readInt8(),e.sec=t.readInt8(),e.frame=t.readInt8(),e.subframe=t.readInt8(),e;case 88:if(e.subtype="timeSignature",4!==r)throw"Expected length for timeSignature event is 4, got "+r;return e.numerator=t.readInt8(),e.denominator=Math.pow(2,t.readInt8()),e.metronome=t.readInt8(),e.thirtyseconds=t.readInt8(),e;case 89:if(e.subtype="keySignature",2!==r)throw"Expected length for keySignature event is 2, got "+r;return e.key=t.readInt8(!0),e.scale=t.readInt8(),e;case 127:return e.subtype="sequencerSpecific",e.data=t.read(r),e;default:return e.subtype="unknown",e.data=t.read(r),e}}else{var i;0===(128&n)?(i=n,n=this.lastEventTypeByte):(i=t.readInt8(),this.lastEventTypeByte=n);var s=n>>4;switch(e.channel=15&n,e.type="channel",s){case 8:return e.subtype="noteOff",e.noteNumber=i,e.velocity=t.readInt8(),e;case 9:return e.noteNumber=i,e.velocity=t.readInt8(),0===e.velocity?e.subtype="noteOff":e.subtype="noteOn",e;case 10:return e.subtype="noteAftertouch",e.noteNumber=i,e.amount=t.readInt8(),e;case 11:return e.subtype="controller",e.controllerType=i,e.value=t.readInt8(),e;case 12:return e.subtype="programChange",e.programNumber=i,e;case 13:return e.subtype="channelAftertouch",e.amount=i,e;case 14:return e.subtype="pitchBend",e.value=i+(t.readInt8()<<7),e;default:throw"Unrecognised MIDI event type: "+s}}},t}());n.Midifile=s;var u=function(){function t(t){this.position=0,this.str=t}return t.prototype.read=function(t){var e=this.str.substr(this.position,t);return this.position+=t,e},t.prototype.readInt32=function(){var t=(this.str.charCodeAt(this.position)<<24)+(this.str.charCodeAt(this.position+1)<<16)+(this.str.charCodeAt(this.position+2)<<8)+this.str.charCodeAt(this.position+3);return this.position+=4,t},t.prototype.readInt16=function(){var t=(this.str.charCodeAt(this.position)<<8)+this.str.charCodeAt(this.position+1);return this.position+=2,t},t.prototype.readInt8=function(t){var e=this.str.charCodeAt(this.position);return t&&e>127&&(e-=256),this.position+=1,e},t.prototype.eof=function(){return this.position>=this.str.length},t.prototype.readVarInt=function(){for(var t=0;;){var e=this.readInt8();if(!(128&e))return t+e;t+=127&e,t<<=7}},t}()},{}],3:[function(t,e,n){"use strict";var r=t("./processing");window.onload=function(){function t(t){var e=t.target.files,n=e[0],a=new FileReader;a.addEventListener("load",function(){r.parsethefile(a.result)}),a.readAsBinaryString(n)}document.getElementById("file").addEventListener("change",t,!1)}},{"./processing":4}],4:[function(t,e,n){"use strict";function r(e){var n=new a.Midifile(e),r=o.GetTempo(n),i=o.CreateDBLines(o.getnotes(n)),s=o.CreateFileString(i,r),u=t("downloadjs");u(s.join(""),"songtest.txt","text/plain"),console.log("AAAAAAA")}var a=t("./MidiFile"),o=t("./utilityfunctions");n.parsethefile=r},{"./MidiFile":2,"./utilityfunctions":5,downloadjs:1}],5:[function(t,e,n){"use strict";function r(t){var e=t.tracks[0].filter(function(t){return null!=t.microsecondsPerBeat})[0].microsecondsPerBeat;return e=6e7/e,e=Math.round(e),10*e}function a(t){for(var e=[],n=0;n<t.tracks.length;n++){e[n]=[];for(var r=0,a=t.tracks[n];r<a.length;r++){var o=a[r];10!==o.channel&&("noteOn"===o.subtype&&e[n].push(o.noteNumber),"noteOff"===o.subtype&&e[n].push(-1))}}for(var i=0;i<e.length;i++)0===e[i].length&&e.splice(i,1);return e}function o(t){var e=[];if(e.push("// Set track wave to channel 0 and start\n"),e.push("wset 0,trackwave;\n"),e.push("chwave 0,0;\n"),e.push("chvolume 0,2.5;\n"),e.push("chstart 0;\n"),e.push("\n"),t>1)for(var n=1;n<t;n++)e.push("// Set track wave to channel "+n+"and start\n"),e.push("wset "+n+",trackwave;\n"),e.push("chwave "+n+","+n+";\n"),e.push("chvolume "+n+",2.5;\n"),e.push("chstart "+n+";\n"),e.push("\n");return e}function i(t){for(var e=[],n=0;n<t.length;n++){for(e[n]=[],e[n].push("track"+n+":\n");t[n].length;)e[n].push("db ".concat(t[n].splice(0,32).join(", ")).concat(";\n"));e[n].push("db 0; // End string\n")}return e}function s(t){var e=[];if(e.push("    // Track 0\n"),e.push("note = 2;\n"),e.push("fpwr note,(track0[i]/12);\n"),e.push("note /= 100;\n"),e.push("chpitch 0,note;\n"),e.push("\n"),t>1)for(var n=1;n<t;n++)e.push("    // Track "+n+"\n"),e.push("note = 2;\n"),e.push("fpwr note,(track"+n+"[i]/12);\n"),e.push("note /= 100;\n"),e.push("chpitch "+n+",note;\n"),e.push("\n");return e}function u(t,e,n){var r=[];return r.push("// Get track length\n"),r.push("tracklen = strlen(track"+e+");\n"),r.push("\n"),r.push("void main()\n"),r.push("{\n"),r.push("    tempo("+n+")\n"),r.push("\n"),r=r.concat(s(t)),r.push("    // Index\n"),r.push("i++; mod i,tracklen;\n"),r.push("\n"),r.push("    // Repeat\n"),r.push("jmp main;\n"),r.push("}\n"),r.push("\n"),r.push("// Accurate tempo function for beats-per-minute\n"),r.push("void tempo( float bpm )\n"),r.push("{\n"),r.push("    timer timestamp;\n"),r.push("    while ((time - timestamp) < (60 / bpm)) { timer time; }\n"),r.push("}\n"),r.push("\n"),r.push("// Returns the length of a string\n"),r.push("float strlen(char* str)\n"),r.push("{\n"),r.push("    char* strptr = str;\n"),r.push("   while (*strptr++);\n"),r.push("  return (strptr - str);\n"),r.push("}\n"),r.push("\n"),r.push("float note, i;\n"),r.push("float tracklen;\n"),r.push("float time, timestamp;\n"),r.push("\n"),r.push('string trackwave,"synth/sine_880.wav";\n'),r.push("\n"),r}function c(t,e){var n=t.map(function(t){return t.length}).indexOf(Math.max.apply(Math,t.map(function(t){return t.length}))),r=o(t.length);r=r.concat(u(t.length,n,e));for(var a=0,i=t;a<i.length;a++){var s=i[a];r=r.concat(s),r.push("\n")}return r}n.GetTempo=r,n.getnotes=a,n.CreateDBLines=i,n.CreateFileString=c},{}]},{},[3]);
//# sourceMappingURL=data.js.map
